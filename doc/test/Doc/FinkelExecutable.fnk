;;;; Test codes for "finkel-executable.rst".

(defmodule Doc.FinkelExecutable
  (export spec)
  (import
   ;; base
   (System.Info (os))

   ;; filepath
   (System.FilePath (</>))

   ;; hspc
   (Test.Hspec ((Spec) before_ describe))

   ;; Internal
   (Doc.TestAux)))

(defn (:: spec Spec)
  (let ((= dir (</> "include" "finkel-executable"))
        (= is-osx (== os "darwin"))
        (= is-win (== os "mingw32"))
        (= skips [(, "finkel-help-make.console" (const is-win))
                  (, "hello.console" (const (|| is-osx is-win)))
                  (, "hello-prof.console" (const is-win))]))
    (before_
     (remove-compiled [(</> dir "hello")])
     (describe "using the finkel executable"
       (run-console-tests dir skips)))))
